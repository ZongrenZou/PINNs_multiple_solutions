clear all
close all

data1 = [   1          3.4326e-01   1.0000000
   2          1.0147e-01   1.0000000
   3          2.9902e-02   1.0000000
   4          8.7363e-03   1.0000000
   5          2.4838e-03   1.0000000
   6          7.4749e-04   1.0000000
   7          5.7495e-04   0.5000000
   8          5.4159e-04   0.1250000
   9          5.2412e-04   0.0625000
  10          5.1320e-04   0.0625000
  11          4.0653e-04   0.1250000
  12          1.8287e-04   0.5000000
  13          3.9175e-05   1.0000000
  14          1.4132e-06   1.0000000
  15          1.2022e-06   0.5000000
  16          7.8094e-07   0.5000000
  17          4.1490e-07   1.0000000
  18          1.8121e-07   1.0000000
  19          7.6699e-08   0.5000000
  20          2.0773e-08   1.0000000
  21          6.1911e-09   1.0000000
  22          4.3656e-10   1.0000000
  23          4.1837e-11   1.0000000
  24          4.1837e-11   0.0000000
  25          3.2160e-11   0.2500000
  26          2.5574e-11   0.2500000
  27          1.0400e-11   1.0000000
  28          8.5478e-12   0.5000000];

data2 = [   1          1.8273e-02   1.0000000
   2          5.3039e-03   1.0000000
   3          1.4794e-03   1.0000000
   4          3.5954e-04   1.0000000
   5          7.5005e-05   1.0000000
   6          6.4652e-05   0.2500000
   7          5.6902e-05   0.2500000
   8          5.0738e-05   0.2500000
   9          4.5466e-05   0.2500000
  10          4.0265e-05   0.2500000
  11          3.6341e-05   0.1250000
  12          3.3795e-05   0.1250000
  13          3.2600e-05   0.1250000
  14          3.1284e-05   0.1250000
  15          2.9501e-05   0.1250000
  16          2.7410e-05   0.1250000
  17          2.5348e-05   0.1250000
  18          2.2738e-05   0.2500000
  19          1.9470e-05   0.2500000
  20          1.8124e-05   0.2500000
  21          1.6227e-05   0.2500000
  22          1.4058e-05   0.2500000
  23          1.2005e-05   0.5000000
  24          9.2485e-06   0.5000000
  25          5.4087e-06   1.0000000
  26          1.3126e-07   1.0000000
  27          9.3491e-10   1.0000000
  28          2.4950e-13   1.0000000];

data3 = [   1          1.9412e-02   1.0000000
   2          5.6408e-03   1.0000000
   3          1.5790e-03   1.0000000
   4          3.8848e-04   1.0000000
   5          7.7016e-05   1.0000000
   6          6.5730e-05   0.2500000
   7          5.7742e-05   0.2500000
   8          5.1633e-05   0.2500000
   9          4.6556e-05   0.2500000
  10          4.1809e-05   0.2500000
  11          3.6355e-05   0.2500000
  12          3.4032e-05   0.1250000
  13          3.2524e-05   0.1250000
  14          3.1048e-05   0.1250000
  15          2.9356e-05   0.1250000
  16          2.7557e-05   0.1250000
  17          2.5462e-05   0.2500000
  18          2.0649e-05   0.2500000
  19          1.9013e-05   0.2500000
  20          1.7265e-05   0.2500000
  21          1.5188e-05   0.2500000
  22          1.2948e-05   0.2500000
  23          1.1122e-05   0.5000000
  24          8.2519e-06   0.5000000
  25          4.1478e-06   1.0000000
  26          7.3883e-08   1.0000000
  27          3.0738e-10   1.0000000
  28          2.6134e-13   1.0000000];


it1 = data1(:, 1);
res1 = data1(:, 2);
it1 = [0; it1];
res1 = [1.3575e+00; res1];
it2 = data2(:, 1);
res2 = data2(:, 2);
it2 = [0; it2];
res2 = [1.2039e+00; res2];
it3 = data3(:, 1);
res3 = data3(:, 2);
it3 = [0; it3];
res3 = [1.4809e+00; res3];


figure;
semilogy(it1, res1, "LineWidth", 2);
hold on;
semilogy(it2, res2, "LineWidth", 2);
semilogy(it3, res3, "LineWidth", 2);
xlabel("\# of iterations", "FontSize", 20, "Interpreter", "latex")
ylabel("Residual", "FontSize", 20, "Interpreter", "latex")
legend(["$u_1$", "$u_2$", "$u_3$"], "FontSize", 20, "Interpreter", "latex")
legend boxoff
box on
ax = gca;
ax.XTick = unique( round(ax.XTick) );
exportgraphics(ax,'residual_new.png','Resolution',300) 